"array"!=typeof affiliData&&(window.affiliData=window.affiliData||[]),"function"!=typeof affili&&(window.affili=function(){affiliData.push(arguments)}),function(o,s){const n={setConversion(e){return s.request.ajax("POST","https://core.affili.ir/api/v2/clients/conversion",e)},setCustomer(e){return s.request.ajax("POST","https://core.affili.ir/api/v2/clients/customer",e)}};let l={accountId:void 0,deleteCookie:void 0,referrer:void 0,affId:void 0};function e(){if(o){console.log("%cAffili is ready ;)","color: #e733b8; font-size:13px;"),setInterval(t,1e3);for(let e=0;e<o.affiliData.length;e++)o.affiliData[e]._id||(o.affiliData[e]={_id:s.makeid(10),func:o.affiliData[e],called:!1})}else setTimeout(()=>e(),100)}const c={detect(e=0,t){console.warn('AFFILI -> ::detect:: The "detect" method is currently deprecated. Just call the "create" method.')},create(e=null,t=function(){}){l.accountId=e;var o=s.request.getUrlParam("aff_id",null),r=s.request.getUrlParam("referrer",null),a=s.request.getUrlParam("dl",1),i=s.request.getUrlParam("exp",30);return void 0===o||void 0===r||void 0===a||void 0===i?(console.warn('AFFILI -> ::create:: The "window.location" is undefined and not set yet! We automatically try again.'),setTimeout(()=>{this.create(e,t)},100)):(console.info("AFFILI -> ::create:: All of the parameters are correctly set."),null===o||null===r?(console.info("AFFILI -> ::create:: Nothing to detect."),!1):(a=JSON.stringify({deleteCookie:a,referrer:r,affId:o}),s.cookies.set("AFFILI_DATA",btoa(a),{expires:parseInt(i)||30}),t(),void console.info("AFFILI -> ::create:: Cookies Set.")))},crossDomain(o,e={}){const r=s.request.getUrlParam("aff_id",null),a=s.request.getUrlParam("referrer",null),i=s.request.getUrlParam("dl",1),n=s.request.getUrlParam("exp",30);return void 0===r||void 0===a||void 0===i||void 0===n?(console.warn('AFFILI -> ::crossDomain:: The "window.location" is undefined and not set yet! We automatically try again.'),setTimeout(()=>{this.crossDomain(o,e)},100)):null!==r&&null!==a&&void setTimeout(()=>{var e=document.createElement("iframe"),t=(e.setAttribute("id","aff-cross-domain-mode"),e.style.display="none",document.body.appendChild(e),new URL(o));t.searchParams.set("aff_id",r),t.searchParams.set("referrer",a),t.searchParams.set("dl",i),t.searchParams.set("exp",n),e.setAttribute("src",t)},1e3)},conversion(e,t,o={},r=!0,a=function(){}){this.sale(e,t,o,r,a)},sale(e,t,o={},r=!0,a=function(){}){try{l=Object.assign({},l,JSON.parse(atob(s.cookies.get("AFFILI_DATA",""))))}catch(e){l.affId=s.cookies.get("affili_aff_id",null),l.referrer=s.cookies.get("affili_referrer",null),l.deleteCookie=s.cookies.get("delete_cookie",1)}var i;return void 0===l.affId||void 0===l.referrer||void 0===l.deleteCookie?(console.warn("AFFILI -> ::conversion:: Vars are not set yet! We automatically try again."),setTimeout(()=>{this.conversion(e,t,o,r,a)},100)):(console.info("AFFILI -> ::conversion:: All of the parameters are availabe and we can track the conversion."),null===l.affId||null===l.referrer?(console.info("AFFILI -> ::conversion:: Cookies are not set."),!1):(o.constructor==="".constructor&&(o={}),i=Object.assign({},{meta_data:null,coupon:null,products:null,type:"sale"},o,{account_id:l.accountId,aff_id:l.affId,referrer:l.referrer,order_id:e,amount:t}),n.setConversion(i).then(e=>{["1",1,"true",!0].includes(l.deleteCookie)&&!0===r&&c.reset(),console.info("AFFILI -> ::conversion:: The conversion tracked, successfully.")}).catch(e=>{}),void a()))},lead(e={},t=function(){}){try{l=Object.assign({},l,JSON.parse(atob(s.cookies.get("AFFILI_DATA",""))))}catch(e){l.affId=s.cookies.get("affili_aff_id",null),l.referrer=s.cookies.get("affili_referrer",null),l.deleteCookie=s.cookies.get("delete_cookie",1)}var o;return void 0===l.affId||void 0===l.referrer||void 0===l.deleteCookie?(console.warn("AFFILI -> ::lead:: Vars are not set yet! We automatically try again."),setTimeout(()=>{this.lead(e,t)},100)):(console.info("AFFILI -> ::lead:: All of the parameters are availabe and we can track the lead."),null===l.affId||null===l.referrer?(console.info("AFFILI -> ::lead:: Cookies are not set."),!1):(o=Object.assign({},{meta_data:null,type:"lead"},e,{account_id:l.accountId,aff_id:l.affId,referrer:l.referrer}),void n.setConversion(o).then(e=>{t("success",e)}).catch(e=>{t("failed",e)})))},customer(e,t={},o=function(e){}){var r=s.getAffiliData(),e=Object.assign({},{mcs_id:e,referrer:r.referrer,meta_data:t});n.setCustomer(e).then(e=>{o(e.data.customer_id)}).catch(e=>{})},reset(e=function(){}){l.affId=void 0,l.referrer=void 0,s.cookies.remove("delete_cookie"),s.cookies.remove("affili_referrer"),s.cookies.remove("affili_aff_id"),s.cookies.remove("AFFILI_DATA"),e()},log(e=function(){}){var t=s.cookies.get("AFFILI_DATA",null),t=null===t?{}:JSON.parse(atob(t));console.table({accountId:l.accountId,...t}),e()},__data__(e=function(){}){var t=s.cookies.get("AFFILI_DATA",null);e(null===t?{}:JSON.parse(atob(t)))}},t=()=>{for(let e=0;e<o.affiliData.length;e++){var t;o.affiliData[e]._id&&!o.affiliData[e].called&&(t=Array.prototype.slice.call(o.affiliData[e].func,1),void 0!==c[o.affiliData[e].func[0]]?c[o.affiliData[e].func[0]](...t):console.warn('AFFILI -> ::execute:: The "'+(o.affiliData[e].func[0]||"")+'" function does not exists!'),o.affiliData[e].called=!0)}};o.affiliData.push=function(e){Array.prototype.push.call(affiliData,{_id:s.makeid(10),func:e,called:!1})};e()}(window,{cookies:function(s,i){function n(t){for(let e=1;e<arguments.length;e++){var o,r=arguments[e];for(o in r)t[o]=r[o]}return t}function o(t,o,r){if("undefined"!=typeof document){"number"==typeof(r=n({},i,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);let e="";for(var a in r)r[a]&&(e+="; "+a,!0!==r[a])&&(e+="="+r[a].split(";")[0]);return document.cookie=t+"="+s.write(o,t)+e}}return Object.create({set:o,get:function(t,e=void 0){if("undefined"!=typeof document&&(!arguments.length||t)){var o=document.cookie?document.cookie.split("; "):[],r={};for(let e=0;e<o.length;e++){var a=o[e].split("="),i=a.slice(1).join("=");try{var n=decodeURIComponent(a[0]);if(r[n]=s.read(i,n),t===n)break}catch(e){}}return t?r[t]||e:r}},remove:function(e,t){o(e,"",n({},t,{expires:-1}))},withAttributes:function(e){return init(this.converter,n({},this.attributes,e))},withConverter:function(e){return init(n({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(s)}})}({read(e){return(e='"'===e[0]?e.slice(1,-1):e).replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/",domain:["localhost","127.0.0.1"].includes(location.hostname)?location.hostname:"."+location.hostname.split(".").slice(-2).join(".")}),request:{getUrlVars(){function e(e){return decodeURIComponent(e.replace(/\+/g," "))}let t={},o=window.location.search.substring(1),r=window.location.hash.substring(1),a=o.split("&");for(var i in a=a.concat(r.split("&")))a.hasOwnProperty(i)&&1<(i=a[i].toString().split("=")).length&&(t[e(i[0])]=e(i[1]));return t},getUrlParam(e,t=null){return window.location?this.getUrlVars()[e]||t:void 0},ajax(a,i,n){return new Promise((t,o)=>{var e="undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),r=(e.withCredentials=!0,e.addEventListener("loadend",e=>{200<=e.target.status&&e.target.status<400?t(JSON.parse(e.target.response)):o(e)}),JSON.stringify(n));e.open(a,i),e.setRequestHeader("Content-type","application/json; charset=utf-8"),e.setRequestHeader("Access-Control-Allow-Headers","x-requested-with"),e.send(r)})}},makeid(t){let o="";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=r.length;for(let e=0;e<t;e++)o+=r.charAt(Math.floor(Math.random()*a));return o},waitForGlobal(e,t=function(){}){window[e]?t():setTimeout(()=>this.waitForGlobal(e,t),100)},getAffiliData(){try{return Object.assign({},JSON.parse(atob(this.cookies.get("AFFILI_DATA","{}"))))}catch(e){return{}}}});